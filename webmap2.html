
<!DOCTYPE html>
<html>
<head>
  <title>Vägkarta med slitlager</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Rekommenderade vägar för tyngre transporter, höjdhinder, fartkameror. Baserad på Lantmäteriets Vägkarta.">
  <meta charset="utf-8" />

  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.8.0/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.8.0/dist/leaflet.js" ></script>
  <style type="text/css">
    body {
       margin: 0;
       padding: 0;
    }
    html, body, #map{
       width: 100%;
       height: 100%;
    }
  </style>
</head>
<body>
  <div id="map"></div>
  <script>
      
      var slitlagerkarta = L.tileLayer('https://filedn.eu/lBi7OlMJML8z9XgfydjnDsm/slitlagerkarta/{z}/{x}/{y}.jpg', {
        maxNativeZoom: 14,
        minZoom: 6,
        tms: false,
        attribution: 'jole84.github.io'
      });
      
      var streetmap = L.tileLayer('https://filedn.eu/lBi7OlMJML8z9XgfydjnDsm/slitlagerkarta_nedtonad/{z}/{x}/{y}.jpg', {
        maxNativeZoom: 14,
        minZoom: 6,
        tms: false,
        attribution: 'jole84.github.io'
      });

      var topo = L.tileLayer('https://minkarta.lantmateriet.se/map/topowebbcache/?layer=topowebb&style=default&tilematrixset=3857&Service=WMTS&Request=GetTile&Version=1.0.0&Format=image/png&TileMatrix={z}&TileCol={x}&TileRow={y}', {
        maxNativeZoom: 17,
        tms: false,
        attribution: 'Lantmäteriet'
      });

      var topo_wmts = L.tileLayer.wms('https://minkarta.lantmateriet.se/map/topowebbcache/?TileMatrix={z}&TileCol={x}&TileRow={y}', {
        layers: 'topoweb',
        service: 'wmts',
        format: 'image/png',
        TileMatrixSet: '3857',
        styles: 'default',
        tms: false,
        attribution: 'Lantmäteriet',
      });

      var topowebb_nedtonad = L.tileLayer('https://minkarta.lantmateriet.se/map/topowebbcache/?layer=topowebb_nedtonad&style=default&tilematrixset=3857&Service=WMTS&Request=GetTile&Version=1.0.0&Format=image/png&TileMatrix={z}&TileCol={x}&TileRow={y}', {
        maxNativeZoom: 17,
        tms: false,
        attribution: 'Lantmäteriet'
      });

      var eniroaerial = L.tileLayer('http://map.eniro.se/geowebcache/service/tms1.0.0/aerial/{z}/{x}/{y}.jpeg', {
        tms: true,
        attribution: 'Eniro'
      });

      var eniromap = L.tileLayer('http://map.eniro.se/geowebcache/service/tms1.0.0/map/{z}/{x}/{y}.png', {
        tms: true,
        attribution: 'Eniro'
      });

      var enironautical = L.tileLayer('http://map.eniro.se/geowebcache/service/tms1.0.0/nautical/{z}/{x}/{y}.png', {
        tms: true,
        attribution: 'Eniro'
      });

      var enirohistorical = L.tileLayer('https://map01.eniro.no/geowebcache/service/tms1.0.0/se_aerial_1950_60s/{z}/{x}/{y}.jpeg', {
        tms: true,
        attribution: 'Eniro'
      });

      var hitta_friluft = L.tileLayer('https://static.hitta.se/tile/v3/4/{z}/{x}/{y}', {
        tms: true,
        attribution: 'hitta'
      });

      var hitta_karta = L.tileLayer('https://static.hitta.se/tile/v3/0/{z}/{x}/{y}', {
        tms: true,
        attribution: 'hitta'
      });

      var hitta_satellit = L.tileLayer('https://static.hitta.se/tile/v3/1/{z}/{x}/{y}', {
        tms: true,
        attribution: 'hitta'
      });

      var openstreetmap = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        tms: false,
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
      });

      var opentopomap = L.tileLayer('https://opentopomap.org/{z}/{x}/{y}.png', {
        tms: false,
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
      });

      var topo_60 = L.tileLayer.wms('https://minkarta.lantmateriet.se/map/historiskaortofoto/service?', {
      layers: 'OI.Histortho_60'
      });

      var topo_75 = L.tileLayer.wms('https://minkarta.lantmateriet.se/map/historiskaortofoto/service?', {
      layers: 'OI.Histortho_75'
      });

      var terrangskuggning = L.tileLayer.wms('https://minkarta.lantmateriet.se/map/hojdmodell/SERVICE?', {
      layers: 'terrangskuggning',
      transparent: false,
      opacity: 0.5
      });

      var grans = L.tileLayer.wms('https://minkarta.lantmateriet.se/map/fastighetsindelning/SERVICE?', {
      layers: 'granser,text,fiske',
      transparent: true,
      opacity: 1,
      format: 'image/png',
      style: 'registerkarta,registerkarta',
      });

      var Trafikplatsnummer = L.tileLayer.wms('https://geo-netinfo.trafikverket.se/MapService/wms.axd/NetInfoRoad_1_2?', {
      layers: 'Trafikplatsnummer',
      transparent: true,
      format: 'image/png',
      });

      var tele2 = L.tileLayer('https://mim.tele2.com/MIMCore/api/Tile/GetOverlay?x={x}&y={y}&z={z}&viewType=1&serviceThresholdIds=69,90,111&countryCode=SWE&currentServiceLayerNo=100', {
      transparent: true,
      format: 'image/png',
      });

      var ATK_Matplats = L.tileLayer.wms('https://geo-netinfo.trafikverket.se/MapService/wms.axd/NetInfo_1_4?', {
      layers: 'ATK_Matplats,Rastplats',
      transparent: true,
      format: 'image/png',
      });

      var nvdb = L.tileLayer.wms('https://geo-netinfo.trafikverket.se/MapService/wms.axd/NetInfo_1_4?', {
      layers: 'Vaghinder',
      transparent: true,
      format: 'image/png',
      });

      var nvdb_slitlager = L.tileLayer.wms('https://geo-netinfo.trafikverket.se/MapService/wms.axd/NetInfo_1_4?', {
      layers: 'Slitlager',
      transparent: true,
      format: 'image/png',
      });

      var nvdb_begransning = L.tileLayer.wms('https://geo-netinfo.trafikverket.se/MapService/wms.axd/NetInfo_1_4?', {
      layers: 'BegransatAxelBoggitryck,BegransadBruttovikt,BegransadFordonslangd',
      transparent: true,
      format: 'image/png',
      });

      var ortofoto16 = L.tileLayer.wms('https://minkarta.lantmateriet.se/map/ortofoto/SERVICE?', {
      layers: 'Ortofoto_0.16',
      });

      var ortofoto25 = L.tileLayer.wms('https://minkarta.lantmateriet.se/map/ortofoto/SERVICE?', {
      layers: 'Ortofoto_0.25',
      });

      var ortofoto4 = L.tileLayer.wms('https://minkarta.lantmateriet.se/map/ortofoto/SERVICE?', {
      layers: 'Ortofoto_0.4',
      });

      var ortofoto5 = L.tileLayer.wms('https://minkarta.lantmateriet.se/map/ortofoto/SERVICE?', {
      layers: 'Ortofoto_0.5',
      });

      var ortofotoir = L.tileLayer.wms('https://minkarta.lantmateriet.se/map/ortofoto/SERVICE?', {
      layers: 'Ortofoto_IR',
      });

      // var today = new Date();
      // console.log(today.toISOString());
      // pmpfrekvent:temperature-2m_n-europe_rainbow_::2022-12-17T21:00:00Z
      // pmpfrekvent:precipitation-1h_n-europe_wpt::2022-12-17T21:00:00Z

      var smhi = L.tileLayer.wms('https://wts1.smhi.se/tile/?', {
      layers: 'baltrad:radarcomp-lightning_scandinavia_wpt',
      format: 'image/png',
      crs: L.CRS.EPSG900913,
      transparent: true,
      });

      var smhi_temp = L.tileLayer.wms('https://wts1.smhi.se/tile/?', {
      layers: 'pmpfrekvent:temperature-2m_n-europe_rainbow_',
      format: 'image/png',
      crs: L.CRS.EPSG900913,
      transparent: true,
      opacity: 0.5,
      maxNativeZoom: 10,
      });

      var smhi_vind = L.tileLayer.wms('https://wts1.smhi.se/tile/?', {
      layers: 'pmp25_vind_lufttryck__havochkust-gradient',
      format: 'image/png',
      crs: L.CRS.EPSG900913,
      transparent: true,
      });

      var eniro_hybrid = L.tileLayer('https://map01.eniro.no/geowebcache/service/tms1.0.0/hybrid/{z}/{x}/{y}.png', {
        tms: true,
        transparent: false,
        attribution: 'Eniro'
      });

      var map = L.map('map', {
        center: [57.78564196397448, 14.215799665093242],
        zoom: 10,
        layers: [slitlagerkarta]
      });

      function onLocationFound(e) {
        var radius = e.accuracy;

        L.marker(e.latlng).bindPopup('Du är här: ' + e.latlng.lat.toString() + "," + e.latlng.lng.toString()).addTo(map);
      }

      map.on('locationfound', onLocationFound);

      map.locate({setView: true, maxZoom: 12});

      var marker1 = L.marker([57, 14]).bindPopup('testmarker1'),
          marker2 = L.marker([58, 15]).bindPopup('testmarker2');

      var markers = L.layerGroup([marker1, marker2]);

      L.GridLayer.GridDebug = L.GridLayer.extend({
        createTile: function (coords) {
          const tile = document.createElement('div');
          tile.style.outline = '1px solid black';
          tile.style.fontWeight = 'bold';
          tile.style.fontSize = '16pt';
          tile.innerHTML = [coords.z, coords.x, coords.y].join('/');
          return tile;
        },
      });

      L.gridLayer.gridDebug = function (opts) {
        return new L.GridLayer.GridDebug(opts);
      };

      var tileName = L.gridLayer.gridDebug();
      
      var baseLayers = {
        'Slitlagerkarta': slitlagerkarta,
        'Vägkarta': streetmap,
        'Lantmäteriet Topo' : topo,
        'topo wmts' : topo_wmts,
        'Topo Nedtonad' : topowebb_nedtonad,
        'Lantmäteriet Orto 0.16' : ortofoto16,
        'Lantmäteriet Orto 0.25' : ortofoto25,
        'Lantmäteriet Orto 0.4' : ortofoto4,
        'Lantmäteriet Orto 0.5' : ortofoto5,
        'Lantmäteriet Orto IR' : ortofotoir,
        'Flygfoto 60':topo_60,
        'Flygfoto 75':topo_75,
        'Eniro Karta': eniromap,
        'Eniro Flygfoto': eniroaerial,
        'Eniro Historisk': enirohistorical,
        'Eniro Sjökort': enironautical,
        'Hitta Karta' : hitta_karta,
        'Hitta Friluft' : hitta_friluft,
        'Hitta Satellit' : hitta_satellit,
        'OpenStreetMap' : openstreetmap,
        'OpenTopoMap' : opentopomap,
      };
      
      var overlayMaps = {
        'Eniro hybrid' : eniro_hybrid,
        'terrangskuggning' : terrangskuggning,
        'markers' : markers,
        'gränser' : grans,
        'Fartkamera/Rastplats' : ATK_Matplats,
        'Trafikplatsnummer' : Trafikplatsnummer,
        'SMHI nederbörd' : smhi,
        'SMHI temp' : smhi_temp,
        'SMHI vind' : smhi_vind,
        'tele2 5G' : tele2,
        'slitlager' : nvdb_slitlager,
        'Begränsning' : nvdb_begransning,
        'tileName' : tileName,
      };


      var layerControl = L.control.layers(baseLayers,overlayMaps,{collapsed:true}).addTo(map);

      map.on('contextmenu',(e) => {
        var streetviewlink = "<a href=\"http://maps.google.com/maps?q=&layer=c&cbll=" + e.latlng.lat.toString() + "," + e.latlng.lng.toString() + "\" target=\"_blank\">Streetview</a>"
        var gmaplink = "<a href=\"http://maps.google.com/maps?q=" + e.latlng.lat.toString() + "," + e.latlng.lng.toString() + "\" target=\"_blank\">Gmap</a>"
        L.popup()
        .setLatLng(e.latlng)
        .setContent(streetviewlink + " " + gmaplink)
        .addTo(map)
        .openOn(map);
      });

      var scale = L.control.scale({metric:true, imperial:false}).addTo(map);


      </script>
</body>
</html>
