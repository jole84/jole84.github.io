<!DOCTYPE html>
<html lang="">
  <head>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" rel="stylesheet"/>
    <!-- MDB -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/6.4.0/mdb.min.css" rel="stylesheet"/>
    <link rel="icon" type="image/svg" href="https://jole84.se/84.png" />
    <script src="filesList.js"></script>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta charset="utf-8">
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <title>jole84.se</title>
    <style>
      #linkButton, #linkButton2 {
        width: 50%;
      }
      #kartbild {
        height: 150px;
        overflow: hidden;
        white-space: nowrap;
        font-size: 0;
        background-color: #bfe6ff;
      }
      #objectpreview {
        width: 100%;
        height: 350px;
        border-radius: 5px;
        pointer-events: none;
      }
      #webbkarta, #ruttplanering {
        width: 300px;
      }
      #legend {
        height: 150px;
      }
      #brouter-img {
        max-width: 100%;
      }
      #selectFile {
        max-width: 300px;
      }
      #karta {
        max-width: 300px;
      }
      #defaultZoom {
        max-width: 100px;
      }
      #infoText {
        max-width: 200px;
      }
      #gpxUrl {
        max-width: 300px;
      }
    </style>
  </head>
  <body>
    <header id="kartbild">
      <img src="https://jole84.se/slitlagerkarta/14/8834/4935.jpg">
      <img src="https://jole84.se/slitlagerkarta/14/8835/4935.jpg">
      <img src="https://jole84.se/slitlagerkarta/14/8836/4935.jpg">
    </header>
    
    <div class="container pt-5">

      <h1>
        Jole84 terräng/vägkarta<br>
      </h1>
      <p class="lead text-muted">Skräddarsydd karta baserad på öppna data från Lantmäteriet (Topografi 50) och vägdata från Trafikverket. Enkel webbaserad applikation för navigering utan behov av app-installation samt oberoende av operativsystem.</p>
      <a href="https://jole84.github.io/legend.svg"><img id="legend" class="rounded" src="https://jole84.github.io/legend.svg"></a><br>
      <hr>

      <a id="linkButton" href="https://jole84.se/nav-app/index.html" class="btn btn-danger my-2">Webbaserad navigationsapp</a>
      <a href="https://jole84.se/route-planner/index.html" class="btn btn-warning my-2">jole84 ruttplanerare (beta)</a>
      <a href="https://jole84.github.io/webmap.html" class="btn btn-primary my-2" id="webbkarta">Webbkarta</a>

      <a id="linkButton3" href="https://jole84.se/nav-app/index.html">
        <div>
          <object id="objectpreview" data="https://jole84.se/nav-app/index.html">Your browser doesn’t support the object tag.</object>
        </div>
      </a>
      <h4>Start-alternativ:</h4>

      <form onchange="myFunction()" id="theForm">
          <label for="gpxUrl"><b>Ladda GPX-fil automatiskt:</b></label>
        <a href="https://jole84.se/rutter" target="_blank">(Tillängliga rutter)</a><br>
        <select class="form-select" id="selectFile">
          <option>välj gpxfil</option>
        </select><br>
        <input class="form-control" id="gpxUrl" name="gpxUrl" size="20" placeholder=".gpx"><br>
      </form>

      <button id="createLink" class="btn btn-primary my-2" onclick="myFunction()">Uppdatera länk</button><br>
      <p><b>Länk för delning:</b><br>
        <code id="linkCode">https://jole84.se/nav-app/index.html</code><br>
      </p>

      <a id="linkButton2" href="https://jole84.se/nav-app/index.html" class="btn btn-danger my-2">Webbaserad navigationsapp</a>

      <hr>
      
      <a href="https://jole84.github.io/brouter-web/index.html" class="btn btn-primary my-2" id="ruttplanering">Ruttplanerare</a><br>
      <a href="https://jole84.github.io/brouter-web/index.html"><img id="brouter-img" class="rounded" src="https://jole84.github.io/brouter-web.jpg"></a><br>

      <a href="https://jole84.se/html_stuff" class="btn btn-primary my-2" id="ruttplanering">Experiment</a>
      <a href="https://jole84.se/html_stuff/gpx2img.html" id="gpx2imgLink">GPX2img</a>
      <hr>

      <a href="https://github.com/jole84">Jole84 Github</a>
    </div>

    <script>
      var linkUrl = document.getElementById('linkUrl');
      var linkCode = document.getElementById('linkCode');
      var linkButton= document.getElementById('linkButton');
      var gpx2imgLink= document.getElementById('gpx2imgLink');
      var gpxUrl = document.getElementById('gpxUrl');
      var selectFile = document.getElementById('selectFile');
      
      var linkUrl = "https://jole84.se/nav-app/index.html"

      function myFunction() {
        for (var i = 0; i < filesList.length; i++) {
          var opt = filesList[i];
          var el = document.createElement("option");
          el.textContent = opt;
          el.value = opt;
          selectFile.appendChild(el);
        }

        
        var newLinkUrl = linkUrl + '?';
        
        if (gpxUrl.value) {
          newLinkUrl += gpxUrl.value;
          gpx2imgLink.setAttribute("href", "https://jole84.se/html_stuff/gpx2img.html?" + gpxUrl.value);
        }

        if (selectFile.value != 'välj gpxfil') {
          newLinkUrl += selectFile.value;
          gpx2imgLink.setAttribute("href", "https://jole84.se/html_stuff/gpx2img.html?" + selectFile.value);
        }

        if (newLinkUrl == linkUrl + '?') {
          linkCode.innerHTML = linkUrl;
          linkButton.setAttribute("href", linkUrl);
          linkButton2.setAttribute("href", linkUrl);
          document.getElementById("linkButton3").setAttribute("href", linkUrl);
        } else {
          linkCode.innerHTML = newLinkUrl;
          linkButton.setAttribute("href", newLinkUrl);
          linkButton2.setAttribute("href", newLinkUrl);
          document.getElementById("linkButton3").setAttribute("href", newLinkUrl);
        }
        document.getElementById('objectpreview').setAttribute("data", newLinkUrl);
      }

      myFunction();
    </script>
  </body>
  </html>
